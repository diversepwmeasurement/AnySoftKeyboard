env:
  TERM: dumb
  TMPDIR: /tmp
jobs:
  contributors-md-update:
    runs-on: self-hosted
    steps:
    - continue-on-error: true
      uses: actions/checkout@v4.1.1
    - continue-on-error: true
      uses: pnpm/action-setup@v3.0.0
      with:
        run_install: true
        version: 8.6.9
    - continue-on-error: true
      uses: actions/setup-node@v4.0.2
      with:
        cache: pnpm
        node-version-file: .nvmrc
    - continue-on-error: true
      run: pnpm build
    - continue-on-error: true
      name: update contributors list
      run: 'git config --global --add safe.directory "${PWD}"

        node dist/contributors/index.js generate --api_token ${{ secrets.BOT_MASTER_RW_GITHUB_TOKEN
        }} --output_file CONTRIBUTORS.md

        '
    - continue-on-error: true
      name: Create pull request
      uses: peter-evans/create-pull-request@v6.0.4
      with:
        author: Polyglot <ask@evendanan.net>
        body: Generated from latest git scan.
        branch: bot-pr/contributors-list-update
        commit-message: Automated Contributors List Update
        committer: Polyglot <ask@evendanan.net>
        delete-branch: true
        team-reviewers: maintainers
        title: Automated Contributors List Update
        token: ${{ secrets.BOT_MASTER_RW_GITHUB_TOKEN }}
name: contributors-lists
on:
  repository_dispatch:
    types: trigger-ga___generate_contributors_list.yml
